sparseLDA = if (exists("sparseLDA")) c(sparseLDA$overall, sparseLDA$byClass) else NA,
rpart = if (exists("rpart")) c(rpart$overall, rpart$byClass) else NA,
cforest = if (exists("cforest")) c(cforest$overall, cforest$byClass) else NA,
ctree = if (exists("ctree")) c(ctree$overall, ctree$byClass) else NA,
#rf = if (exists("rf")) c(rf$overall, rf$byClass) else NA,
AdaBag = if (exists("AdaBag")) c(AdaBag$overall, AdaBag$byClass) else NA,
treebag = if (exists("treebag")) c(treebag$overall, treebag$byClass) else NA,
#bagFDA = if (exists("bagFDA")) c(bagFDA$overall, bagFDA$byClass) else NA,
gamboost = if (exists("gamboost")) c(gamboost$overall, gamboost$byClass) else NA,
bstSm = if (exists("bstSm")) c(bstSm$overall, bstSm$byClass) else NA,
bstTree = if (exists("bstTree")) c(bstTree$overall, bstTree$byClass) else NA,
gpls = if (exists("gpls")) c(gpls$overall, gpls$byClass) else NA,
pls = if (exists("pls")) c(pls$overall, pls$byClass) else NA,
spls = if (exists("spls")) c(spls$overall, spls$byClass) else NA
)
svmRadial$overall
svmRadial$byClass
c(svmRadial$overall, svmRadial$byClass)
# Build Performance-Metrics Table
acc.df <- data.frame(
svmRadial = if (exists("svmRadial")) c(svmRadial$overall, svmRadial$byClass) else NA,
svmPoly = if (exists("svmPoly")) c(svmPoly$overall, svmPoly$byClass) else NA,
svmLinear = if (exists("svmLinear")) c(svmLinear$overall, svmLinear$byClass) else NA,
voomDLDA = if (exists("voomDLDA")) c(voomDLDA$overall, voomDLDA$byClass) else NA,
voomDQDA = if (exists("voomDQDA")) c(voomDQDA$overall, voomDQDA$byClass) else NA,
voomNSC = if (exists("voomNSC")) c(voomNSC$overall, voomNSC$byClass) else NA,
PLDA = if (exists("PLDA")) c(PLDA$overall, PLDA$byClass) else NA,
PLDA2 = if (exists("PLDA2")) c(PLDA2$overall, PLDA2$byClass) else NA,
sparseLDA = if (exists("sparseLDA")) c(sparseLDA$overall, sparseLDA$byClass) else NA,
rpart = if (exists("rpart")) c(rpart$overall, rpart$byClass) else NA,
cforest = if (exists("cforest")) c(cforest$overall, cforest$byClass) else NA,
ctree = if (exists("ctree")) c(ctree$overall, ctree$byClass) else NA,
#rf = if (exists("rf")) c(rf$overall, rf$byClass) else NA,
AdaBag = if (exists("AdaBag")) c(AdaBag$overall, AdaBag$byClass) else NA,
treebag = if (exists("treebag")) c(treebag$overall, treebag$byClass) else NA,
#bagFDA = if (exists("bagFDA")) c(bagFDA$overall, bagFDA$byClass) else NA,
gamboost = if (exists("gamboost")) c(gamboost$overall, gamboost$byClass) else NA,
bstSm = if (exists("bstSm")) c(bstSm$overall, bstSm$byClass) else NA,
bstTree = if (exists("bstTree")) c(bstTree$overall, bstTree$byClass) else NA,
gpls = if (exists("gpls")) c(gpls$overall, gpls$byClass) else NA,
pls = if (exists("pls")) c(pls$overall, pls$byClass) else NA,
spls = if (exists("spls")) c(spls$overall, spls$byClass) else NA
)
if (exists("svmRadial")) c(svmRadial$overall, svmRadial$byClass) else NA
if (exists("svmPoly")) c(svmPoly$overall, svmPoly$byClass) else NA
rm(svmLinear)
rm(svmPoly)
if (exists("svmPoly")) c(svmPoly$overall, svmPoly$byClass) else NA
if (exists("svmLinear")) c(svmLinear$overall, svmLinear$byClass) else NA
# Build Performance-Metrics Table
acc.df <- data.frame(
svmRadial = if (exists("svmRadial")) c(svmRadial$overall, svmRadial$byClass) else NA,
svmPoly = if (exists("svmPoly")) c(svmPoly$overall, svmPoly$byClass) else NA,
svmLinear = if (exists("svmLinear")) c(svmLinear$overall, svmLinear$byClass) else NA,
voomDLDA = if (exists("voomDLDA")) c(voomDLDA$overall, voomDLDA$byClass) else NA,
voomDQDA = if (exists("voomDQDA")) c(voomDQDA$overall, voomDQDA$byClass) else NA,
voomNSC = if (exists("voomNSC")) c(voomNSC$overall, voomNSC$byClass) else NA,
PLDA = if (exists("PLDA")) c(PLDA$overall, PLDA$byClass) else NA,
PLDA2 = if (exists("PLDA2")) c(PLDA2$overall, PLDA2$byClass) else NA,
sparseLDA = if (exists("sparseLDA")) c(sparseLDA$overall, sparseLDA$byClass) else NA,
rpart = if (exists("rpart")) c(rpart$overall, rpart$byClass) else NA,
cforest = if (exists("cforest")) c(cforest$overall, cforest$byClass) else NA,
ctree = if (exists("ctree")) c(ctree$overall, ctree$byClass) else NA,
#rf = if (exists("rf")) c(rf$overall, rf$byClass) else NA,
AdaBag = if (exists("AdaBag")) c(AdaBag$overall, AdaBag$byClass) else NA,
treebag = if (exists("treebag")) c(treebag$overall, treebag$byClass) else NA,
#bagFDA = if (exists("bagFDA")) c(bagFDA$overall, bagFDA$byClass) else NA,
gamboost = if (exists("gamboost")) c(gamboost$overall, gamboost$byClass) else NA,
bstSm = if (exists("bstSm")) c(bstSm$overall, bstSm$byClass) else NA,
bstTree = if (exists("bstTree")) c(bstTree$overall, bstTree$byClass) else NA,
gpls = if (exists("gpls")) c(gpls$overall, gpls$byClass) else NA,
pls = if (exists("pls")) c(pls$overall, pls$byClass) else NA,
spls = if (exists("spls")) c(spls$overall, spls$byClass) else NA
)
View(acc.df)
if ("svmPoly" %in% methods | "svmBased" %in% methods | "all" %in% methods){
svmP <- svm.Poly(data.trainS4, data.testS4, classts)
svmPoly <- svmP[[1]]
genes_svmPoly_SVMBased <- svmP[[2]]
}
# Build Performance-Metrics Table
acc.df <- data.frame(
svmRadial = if (exists("svmRadial")) c(svmRadial$overall, svmRadial$byClass) else NA,
svmPoly = if (exists("svmPoly")) c(svmPoly$overall, svmPoly$byClass) else NA,
svmLinear = if (exists("svmLinear")) c(svmLinear$overall, svmLinear$byClass) else NA,
voomDLDA = if (exists("voomDLDA")) c(voomDLDA$overall, voomDLDA$byClass) else NA,
voomDQDA = if (exists("voomDQDA")) c(voomDQDA$overall, voomDQDA$byClass) else NA,
voomNSC = if (exists("voomNSC")) c(voomNSC$overall, voomNSC$byClass) else NA,
PLDA = if (exists("PLDA")) c(PLDA$overall, PLDA$byClass) else NA,
PLDA2 = if (exists("PLDA2")) c(PLDA2$overall, PLDA2$byClass) else NA,
sparseLDA = if (exists("sparseLDA")) c(sparseLDA$overall, sparseLDA$byClass) else NA,
rpart = if (exists("rpart")) c(rpart$overall, rpart$byClass) else NA,
cforest = if (exists("cforest")) c(cforest$overall, cforest$byClass) else NA,
ctree = if (exists("ctree")) c(ctree$overall, ctree$byClass) else NA,
rf = if (exists("rf")) c(rf$overall, rf$byClass) else NA,
AdaBag = if (exists("AdaBag")) c(AdaBag$overall, AdaBag$byClass) else NA,
treebag = if (exists("treebag")) c(treebag$overall, treebag$byClass) else NA,
bagFDA = if (exists("bagFDA")) c(bagFDA$overall, bagFDA$byClass) else NA,
gamboost = if (exists("gamboost")) c(gamboost$overall, gamboost$byClass) else NA,
bstSm = if (exists("bstSm")) c(bstSm$overall, bstSm$byClass) else NA,
bstTree = if (exists("bstTree")) c(bstTree$overall, bstTree$byClass) else NA,
gpls = if (exists("gpls")) c(gpls$overall, gpls$byClass) else NA,
pls = if (exists("pls")) c(pls$overall, pls$byClass) else NA,
spls = if (exists("spls")) c(spls$overall, spls$byClass) else NA
)
# Build Performance-Metrics Table
acc.df <- data.frame(
svmRadial = if (exists("svmRadial")) c(svmRadial$overall, svmRadial$byClass) else NA,
svmPoly = if (exists("svmPoly")) c(svmPoly$overall, svmPoly$byClass) else NA,
svmLinear = if (exists("svmLinear")) c(svmLinear$overall, svmLinear$byClass) else NA,
voomDLDA = if (exists("voomDLDA")) c(voomDLDA$overall, voomDLDA$byClass) else NA,
voomDQDA = if (exists("voomDQDA")) c(voomDQDA$overall, voomDQDA$byClass) else NA,
voomNSC = if (exists("voomNSC")) c(voomNSC$overall, voomNSC$byClass) else NA,
PLDA = if (exists("PLDA")) c(PLDA$overall, PLDA$byClass) else NA,
PLDA2 = if (exists("PLDA2")) c(PLDA2$overall, PLDA2$byClass) else NA,
sparseLDA = if (exists("sparseLDA")) c(sparseLDA$overall, sparseLDA$byClass) else NA,
rpart = if (exists("rpart")) c(rpart$overall, rpart$byClass) else NA,
cforest = if (exists("cforest")) c(cforest$overall, cforest$byClass) else NA,
ctree = if (exists("ctree")) c(ctree$overall, ctree$byClass) else NA,
#rf = if (exists("rf")) c(rf$overall, rf$byClass) else NA,
AdaBag = if (exists("AdaBag")) c(AdaBag$overall, AdaBag$byClass) else NA,
treebag = if (exists("treebag")) c(treebag$overall, treebag$byClass) else NA,
bagFDA = if (exists("bagFDA")) c(bagFDA$overall, bagFDA$byClass) else NA,
gamboost = if (exists("gamboost")) c(gamboost$overall, gamboost$byClass) else NA,
bstSm = if (exists("bstSm")) c(bstSm$overall, bstSm$byClass) else NA,
bstTree = if (exists("bstTree")) c(bstTree$overall, bstTree$byClass) else NA,
gpls = if (exists("gpls")) c(gpls$overall, gpls$byClass) else NA,
pls = if (exists("pls")) c(pls$overall, pls$byClass) else NA,
spls = if (exists("spls")) c(spls$overall, spls$byClass) else NA
)
# Build Performance-Metrics Table
acc.df <- data.frame(
svmRadial = if (exists("svmRadial")) c(svmRadial$overall, svmRadial$byClass) else NA,
svmPoly = if (exists("svmPoly")) c(svmPoly$overall, svmPoly$byClass) else NA,
svmLinear = if (exists("svmLinear")) c(svmLinear$overall, svmLinear$byClass) else NA,
voomDLDA = if (exists("voomDLDA")) c(voomDLDA$overall, voomDLDA$byClass) else NA,
voomDQDA = if (exists("voomDQDA")) c(voomDQDA$overall, voomDQDA$byClass) else NA,
voomNSC = if (exists("voomNSC")) c(voomNSC$overall, voomNSC$byClass) else NA,
PLDA = if (exists("PLDA")) c(PLDA$overall, PLDA$byClass) else NA,
PLDA2 = if (exists("PLDA2")) c(PLDA2$overall, PLDA2$byClass) else NA,
sparseLDA = if (exists("sparseLDA")) c(sparseLDA$overall, sparseLDA$byClass) else NA,
rpart = if (exists("rpart")) c(rpart$overall, rpart$byClass) else NA,
cforest = if (exists("cforest")) c(cforest$overall, cforest$byClass) else NA,
ctree = if (exists("ctree")) c(ctree$overall, ctree$byClass) else NA,
#rf = if (exists("rf")) c(rf$overall, rf$byClass) else NA,
AdaBag = if (exists("AdaBag")) c(AdaBag$overall, AdaBag$byClass) else NA,
treebag = if (exists("treebag")) c(treebag$overall, treebag$byClass) else NA,
#bagFDA = if (exists("bagFDA")) c(bagFDA$overall, bagFDA$byClass) else NA,
gamboost = if (exists("gamboost")) c(gamboost$overall, gamboost$byClass) else NA,
bstSm = if (exists("bstSm")) c(bstSm$overall, bstSm$byClass) else NA,
bstTree = if (exists("bstTree")) c(bstTree$overall, bstTree$byClass) else NA,
gpls = if (exists("gpls")) c(gpls$overall, gpls$byClass) else NA,
pls = if (exists("pls")) c(pls$overall, pls$byClass) else NA,
spls = if (exists("spls")) c(spls$overall, spls$byClass) else NA
)
if ("rf" %in% methods | "treeBased" %in% methods | "all" %in% methods){
treerf <- tree.rf(data.trainS4, data.testS4, classts)
RF <- treerf[[1]]
genes_rf_treeBased <- treerf[[2]]
}
# Build Performance-Metrics Table
acc.df <- data.frame(
svmRadial = if (exists("svmRadial")) c(svmRadial$overall, svmRadial$byClass) else NA,
svmPoly = if (exists("svmPoly")) c(svmPoly$overall, svmPoly$byClass) else NA,
svmLinear = if (exists("svmLinear")) c(svmLinear$overall, svmLinear$byClass) else NA,
voomDLDA = if (exists("voomDLDA")) c(voomDLDA$overall, voomDLDA$byClass) else NA,
voomDQDA = if (exists("voomDQDA")) c(voomDQDA$overall, voomDQDA$byClass) else NA,
voomNSC = if (exists("voomNSC")) c(voomNSC$overall, voomNSC$byClass) else NA,
PLDA = if (exists("PLDA")) c(PLDA$overall, PLDA$byClass) else NA,
PLDA2 = if (exists("PLDA2")) c(PLDA2$overall, PLDA2$byClass) else NA,
sparseLDA = if (exists("sparseLDA")) c(sparseLDA$overall, sparseLDA$byClass) else NA,
rpart = if (exists("rpart")) c(rpart$overall, rpart$byClass) else NA,
cforest = if (exists("cforest")) c(cforest$overall, cforest$byClass) else NA,
ctree = if (exists("ctree")) c(ctree$overall, ctree$byClass) else NA,
rf = if (exists("RF")) c(rf$overall, rf$byClass) else NA,
AdaBag = if (exists("AdaBag")) c(AdaBag$overall, AdaBag$byClass) else NA,
treebag = if (exists("treebag")) c(treebag$overall, treebag$byClass) else NA,
bagFDA = if (exists("BagFDA")) c(bagFDA$overall, bagFDA$byClass) else NA,
gamboost = if (exists("gamboost")) c(gamboost$overall, gamboost$byClass) else NA,
bstSm = if (exists("bstSm")) c(bstSm$overall, bstSm$byClass) else NA,
bstTree = if (exists("bstTree")) c(bstTree$overall, bstTree$byClass) else NA,
gpls = if (exists("gpls")) c(gpls$overall, gpls$byClass) else NA,
pls = if (exists("pls")) c(pls$overall, pls$byClass) else NA,
spls = if (exists("spls")) c(spls$overall, spls$byClass) else NA
)
# Build Performance-Metrics Table
acc.df <- data.frame(
svmRadial = if (exists("svmRadial")) c(svmRadial$overall, svmRadial$byClass) else NA,
svmPoly = if (exists("svmPoly")) c(svmPoly$overall, svmPoly$byClass) else NA,
svmLinear = if (exists("svmLinear")) c(svmLinear$overall, svmLinear$byClass) else NA,
voomDLDA = if (exists("voomDLDA")) c(voomDLDA$overall, voomDLDA$byClass) else NA,
voomDQDA = if (exists("voomDQDA")) c(voomDQDA$overall, voomDQDA$byClass) else NA,
voomNSC = if (exists("voomNSC")) c(voomNSC$overall, voomNSC$byClass) else NA,
PLDA = if (exists("PLDA")) c(PLDA$overall, PLDA$byClass) else NA,
PLDA2 = if (exists("PLDA2")) c(PLDA2$overall, PLDA2$byClass) else NA,
sparseLDA = if (exists("sparseLDA")) c(sparseLDA$overall, sparseLDA$byClass) else NA,
rpart = if (exists("rpart")) c(rpart$overall, rpart$byClass) else NA,
cforest = if (exists("cforest")) c(cforest$overall, cforest$byClass) else NA,
ctree = if (exists("ctree")) c(ctree$overall, ctree$byClass) else NA,
rf = if (exists("RF")) c(RF$overall, RF$byClass) else NA,
AdaBag = if (exists("AdaBag")) c(AdaBag$overall, AdaBag$byClass) else NA,
treebag = if (exists("treebag")) c(treebag$overall, treebag$byClass) else NA,
bagFDA = if (exists("BagFDA")) c(BagFDA$overall, BagFDA$byClass) else NA,
gamboost = if (exists("gamboost")) c(gamboost$overall, gamboost$byClass) else NA,
bstSm = if (exists("bstSm")) c(bstSm$overall, bstSm$byClass) else NA,
bstTree = if (exists("bstTree")) c(bstTree$overall, bstTree$byClass) else NA,
gpls = if (exists("gpls")) c(gpls$overall, gpls$byClass) else NA,
pls = if (exists("pls")) c(pls$overall, pls$byClass) else NA,
spls = if (exists("spls")) c(spls$overall, spls$byClass) else NA
)
View(acc.df)
# Build Selected genes list of list
list_genes <- list(genes_svmRadial_SVMBased = genes_svmRadial_SVMBased[[1]],
genes_svmPoly_SVMBased = genes_svmPoly_SVMBased[[1]],
genes_svmLinear_SVMBased = genes_svmLinear_SVMBased[[1]],
genes_voomDLDA_voomBased = genes_voomDLDA_voomBased[[1]],
genes_voomDQDA_voomBased = genes_voomDQDA_voomBased[[1]],
genes_voomNSC_voomBased = genes_voomNSC_voomBased[[1]],
genes_PLDA_LDABased = genes_PLDA_LDABased[[1]],
genes_PLDA2_LDABased = genes_PLDA2_LDABased[[1]],
genes_sparseLDA_LDABased = genes_sparseLDA_LDABased[[1]],
genes_rpart_treeBased = genes_rpart_treeBased[[1]],
genes_cforest_treeBased = genes_cforest_treeBased[[1]],
genes_ctree_treeBased = genes_ctree_treeBased[[1]],
genes_rf_treeBased = genes_rf_treeBased[[1]],
genes_AdaBag_baggedBased = genes_AdaBag_baggedBased[[1]],
genes_treebag_baggedBased = genes_treebag_baggedBased[[1]],
genes_gamboost_boostBased = genes_gamboost_boostBased[[1]],
genes_bstSm_boostBased = genes_bstSm_boostBased[[1]],
genes_bstTree_boostBased = genes_bstTree_boostBased[[1]],
genes_gpls_plsBased = genes_gpls_plsBased[[1]],
genes_pls_plsBased = genes_pls_plsBased[[1]],
genes_spls_plsBased = genes_spls_plsBased[[1]])
genes_svmRadial_SVMBased[[1]]
genes_svmRadial_SVMBased
# Build Selected genes list of list
list_genes <- list(
genes_svmRadial_SVMBased = if (exists("genes_svmRadial_SVMBased")) genes_svmRadial_SVMBased[[1]] else NA,
genes_svmPoly_SVMBased = if (exists("genes_svmPoly_SVMBased")) genes_svmPoly_SVMBased[[1]] else NA,
genes_svmLinear_SVMBased = if (exists("genes_svmLinear_SVMBased")) genes_svmLinear_SVMBased[[1]] else NA,
genes_voomDLDA_voomBased = if (exists("genes_voomDLDA_voomBased")) genes_voomDLDA_voomBased[[1]] else NA,
genes_voomDQDA_voomBased = if (exists("genes_voomDQDA_voomBased")) genes_voomDQDA_voomBased[[1]] else NA,
genes_voomNSC_voomBased = if (exists("genes_voomNSC_voomBased")) genes_voomNSC_voomBased[[1]] else NA,
genes_PLDA_LDABased = if (exists("genes_PLDA_LDABased")) genes_PLDA_LDABased[[1]] else NA,
genes_PLDA2_LDABased = if (exists("genes_PLDA2_LDABased")) genes_PLDA2_LDABased[[1]] else NA,
genes_sparseLDA_LDABased = if (exists("genes_sparseLDA_LDABased")) genes_sparseLDA_LDABased[[1]] else NA,
genes_rpart_treeBased = if (exists("genes_rpart_treeBased")) genes_rpart_treeBased[[1]] else NA,
genes_cforest_treeBased = if (exists("genes_cforest_treeBased")) genes_cforest_treeBased[[1]] else NA,
genes_ctree_treeBased = if (exists("genes_ctree_treeBased")) genes_ctree_treeBased[[1]] else NA,
genes_rf_treeBased = if (exists("genes_rf_treeBased")) genes_rf_treeBased[[1]] else NA,
genes_AdaBag_baggedBased = if (exists("genes_AdaBag_baggedBased")) genes_AdaBag_baggedBased[[1]] else NA,
genes_treebag_baggedBased = if (exists("genes_treebag_baggedBased")) genes_treebag_baggedBased[[1]] else NA,
genes_gamboost_boostBased = if (exists("genes_gamboost_boostBased")) genes_gamboost_boostBased[[1]] else NA,
genes_bstSm_boostBased = if (exists("genes_bstSm_boostBased")) genes_bstSm_boostBased[[1]] else NA,
genes_bstTree_boostBased = if (exists("genes_bstTree_boostBased")) genes_bstTree_boostBased[[1]] else NA,
genes_gpls_plsBased = if (exists("genes_gpls_plsBased")) genes_gpls_plsBased[[1]] else NA,
genes_pls_plsBased = if (exists("genes_pls_plsBased")) genes_pls_plsBased[[1]] else NA,
genes_spls_plsBased = if (exists("genes_spls_plsBased")) genes_spls_plsBased[[1]] else NA
)
View(list_genes)
ensembleBP <- function(mincorr = 0.4, cv = 10,
pathdf = "../Data/ACC_Adrenocortical_Carcinoma/ACC_Count.csv",
pathclin = "../Data/ACC_Adrenocortical_Carcinoma/ACC_Pheno.csv",
methods = c("all")){
for (i in c(1:cv)) {
print(paste0("Performing Cross-Validation of ",i," layer"))
crossVal.1layer(seed = i, i = i, mincorr = mincorr,
pathdf = pathdf,
pathclin = pathclin,
methods = methods)
}
}
ensembleBP(methods = c("svmBased"))
crossVal.1layer <- function(seed, i, mincorr = 0.4,
pathdf = "../Data/ACC_Adrenocortical_Carcinoma/ACC_Count.csv",
pathclin = "../Data/ACC_Adrenocortical_Carcinoma/ACC_Pheno.csv",
methods = c("all")){
print("Importing specified datasets")
dfsImport <- dfs.import(pathdf = pathdf, pathclin = pathclin)
df <- dfsImport[[1]]
class <- dfsImport[[2]]
print("Performing mini features trimming")
# Keep only features with at least 10 counts in 1/3 of samples
keep <- rowSums(df > 10) > round(ncol(df)/3)
df <- df[keep, ]
print("Splitting datasets into train and test")
tts <- trainTest.split(df, class, mincorr = mincorr, seed = seed)
data.trainS4 <- tts[[1]]
data.testS4 <- tts[[2]]
classts <- tts[[3]]
# mini-check to see if filtered genes are the same among train and test
print(sum(rownames(assay(data.trainS4)) == rownames(assay(data.testS4))))
print("Starting classification tasks")
## Start running Classifiers
if ("svmRadial" %in% methods | "svmBased" %in% methods | "all" %in% methods){
svmR <- svm.Radial(data.trainS4, data.testS4, classts)
svmRadial <- svmR[[1]]
genes_svmRadial_SVMBased <- svmR[[2]]
}
if ("svmPoly" %in% methods | "svmBased" %in% methods | "all" %in% methods){
svmP <- svm.Poly(data.trainS4, data.testS4, classts)
svmPoly <- svmP[[1]]
genes_svmPoly_SVMBased <- svmP[[2]]
}
if ("svmLinear" %in% methods | "svmBased" %in% methods | "all" %in% methods){
svmL <- svm.Linear(data.trainS4, data.testS4, classts)
svmLinear <- svmL[[1]]
genes_svmLinear_SVMBased <- svmL[[2]]
}
if ("voomDLDA" %in% methods | "voomBased" %in% methods | "all" %in% methods){
vDLDA <- voom.DLDA(data.trainS4, data.testS4, classts)
voomDLDA <- vDLDA[[1]]
genes_voomDLDA_voomBased <- vDLDA[[2]]
}
if ("voomDQDA" %in% methods | "voomBased" %in% methods | "all" %in% methods){
vDQDA <- voom.DQDA(data.trainS4, data.testS4, classts)
voomDQDA <- vDQDA[[1]]
genes_voomDQDA_voomBased <- vDQDA[[2]]
}
if ("voomNSC" %in% methods | "voomBased" %in% methods | "all" %in% methods){
vNSC <- voom.NSC(data.trainS4, data.testS4, classts)
voomNSC <- vNSC[[1]]
genes_voomNSC_voomBased <- vNSC[[2]]
}
if ("PLDA" %in% methods | "LDABased" %in% methods | "all" %in% methods){
linPLDA <- lin.PLDA(data.trainS4, data.testS4, classts)
PLDA <- linPLDA[[1]]
genes_PLDA_LDABased <- linPLDA[[2]]
}
if ("PLDA2" %in% methods | "LDABased" %in% methods | "all" %in% methods){
linPLDA2 <- lin.PLDA2(data.trainS4, data.testS4, classts)
PLDA2 <- linPLDA2[[1]]
genes_PLDA2_LDABased <- linPLDA2[[2]]
}
if ("sparseLDA" %in% methods | "LDABased" %in% methods | "all" %in% methods){
sparse <- sparse.LDA(data.trainS4, data.testS4, classts) # <-- too slow!!
sparseLDA <- sparse[[1]]
genes_sparseLDA_LDABased <- sparse[[2]]
}
if ("rpart" %in% methods | "treeBased" %in% methods | "all" %in% methods){
treerpart <- tree.rpart(data.trainS4, data.testS4, classts)
rpart <- treerpart[[1]]
genes_rpart_treeBased <- treerpart[[2]]
genes_rpart_treeBased <- list(names(genes_rpart_treeBased[[1]]))
}
if ("cforest" %in% methods | "treeBased" %in% methods | "all" %in% methods){
treecforest <- tree.cforest(data.trainS4, data.testS4, classts)
cforest <- treecforest[[1]]
genes_cforest_treeBased <- treecforest[[2]]
}
if ("ctree" %in% methods | "treeBased" %in% methods | "all" %in% methods){
treectree <- tree.ctree(data.trainS4, data.testS4, classts)
ctree <- treectree[[1]]
genes_ctree_treeBased <- treectree[[2]]
}
if ("rf" %in% methods | "treeBased" %in% methods | "all" %in% methods){
treerf <- tree.rf(data.trainS4, data.testS4, classts)
RF <- treerf[[1]]
genes_rf_treeBased <- treerf[[2]]
}
if ("AdaBag" %in% methods | "baggedBased" %in% methods | "all" %in% methods){
bagAda <- bagg.AdaBag(data.trainS4, data.testS4, classts)
AdaBag <- bagAda[[1]]
genes_AdaBag_baggedBased <- bagAda[[2]]
genes_AdaBag_baggedBased <- list(names(genes_AdaBag_baggedBased[[1]][genes_AdaBag_baggedBased[[1]]>0]))
}
if ("treebag" %in% methods | "baggedBased" %in% methods | "all" %in% methods){
bagtree <- bagg.treebag(data.trainS4, data.testS4, classts)
treebag <- bagtree[[1]]
genes_treebag_baggedBased <- bagtree[[2]]
}
if ("bagFDA" %in% methods | "baggedBased" %in% methods | "all" %in% methods){
baggfda <- bagg.bagFDA(data.trainS4, data.testS4, classts)
BagFDA <- baggfda[[1]]
}
if ("gamboost" %in% methods | "boostBased" %in% methods | "all" %in% methods){
bstgam <- boost.gamboost(data.trainS4, data.testS4, classts)
gamboost <- bstgam[[1]]
genes_gamboost_boostBased <- bstgam[[2]]
genes_gamboost_boostBased[[1]] <- sub("bbs\\(([^,]+),.*", "\\1", genes_gamboost_boostBased[[1]])
}
if ("bstSm" %in% methods | "boostBased" %in% methods | "all" %in% methods){
bstbstsm <- boost.bstSm(data.trainS4, data.testS4, classts)
bstSm <- bstbstsm[[1]]
genes_bstSm_boostBased <- bstbstsm[[2]]
}
if ("bstTree" %in% methods | "boostBased" %in% methods | "all" %in% methods){
bsttree <- boost.bstTree(data.trainS4, data.testS4, classts)
bstTree <- bsttree[[1]]
genes_bstTree_boostBased <- bsttree[[2]]
}
if ("gpls" %in% methods | "plsBased" %in% methods | "all" %in% methods){
plsgpls <- pls.gpls(data.trainS4, data.testS4, classts)
gpls <- plsgpls[[1]]
genes_gpls_plsBased <- plsgpls[[2]]
}
if ("pls" %in% methods | "plsBased" %in% methods | "all" %in% methods){
plspls <- pls.pls(data.trainS4, data.testS4, classts)
pls <- plspls[[1]]
genes_pls_plsBased <- plspls[[2]]
}
if ("spls" %in% methods | "plsBased" %in% methods | "all" %in% methods){
plsspls <- pls.spls(data.trainS4, data.testS4, classts)
spls <- plsspls[[1]]
genes_spls_plsBased <- plsspls[[2]]
}
# # Build Performance-Metrics Table
# acc.df <- data.frame(svmRadial = c(svmRadial$overall, svmRadial$byClass),
#                      svmPoly = c(svmPoly$overall, svmPoly$byClass),
#                      svmLinear = c(svmLinear$overall, svmLinear$byClass),
#                      voomDLDA = c(voomDLDA$overall, voomDLDA$byClass),
#                      voomDQDA = c(voomDQDA$overall, voomDQDA$byClass),
#                      voomNSC = c(voomNSC$overall, voomNSC$byClass),
#                      PLDA = c(PLDA$overall, PLDA$byClass),
#                      PLDA2 = c(PLDA2$overall, PLDA2$byClass),
#                      sparseLDA = c(sparseLDA$overall, sparseLDA$byClass),
#                      rpart = c(rpart$overall, rpart$byClass),
#                      cforest = c(cforest$overall, cforest$byClass),
#                      ctree = c(ctree$overall, ctree$byClass),
#                      rf = c(rf$overall, rf$byClass),
#                      AdaBag = c(AdaBag$overall, AdaBag$byClass),
#                      treebag = c(treebag$overall, treebag$byClass),
#                      bagFDA = c(bagFDA$overall, bagFDA$byClass),
#                      gamboost = c(gamboost$overall, gamboost$byClass),
#                      bstSm = c(bstSm$overall, bstSm$byClass),
#                      bstTree = c(bstTree$overall, bstTree$byClass),
#                      gpls = c(gpls$overall, gpls$byClass),
#                      pls = c(pls$overall, pls$byClass),
#                      spls = c(spls$overall, spls$byClass))
# Build Performance-Metrics Table
acc.df <- data.frame(
svmRadial = if (exists("svmRadial")) c(svmRadial$overall, svmRadial$byClass) else NA,
svmPoly = if (exists("svmPoly")) c(svmPoly$overall, svmPoly$byClass) else NA,
svmLinear = if (exists("svmLinear")) c(svmLinear$overall, svmLinear$byClass) else NA,
voomDLDA = if (exists("voomDLDA")) c(voomDLDA$overall, voomDLDA$byClass) else NA,
voomDQDA = if (exists("voomDQDA")) c(voomDQDA$overall, voomDQDA$byClass) else NA,
voomNSC = if (exists("voomNSC")) c(voomNSC$overall, voomNSC$byClass) else NA,
PLDA = if (exists("PLDA")) c(PLDA$overall, PLDA$byClass) else NA,
PLDA2 = if (exists("PLDA2")) c(PLDA2$overall, PLDA2$byClass) else NA,
sparseLDA = if (exists("sparseLDA")) c(sparseLDA$overall, sparseLDA$byClass) else NA,
rpart = if (exists("rpart")) c(rpart$overall, rpart$byClass) else NA,
cforest = if (exists("cforest")) c(cforest$overall, cforest$byClass) else NA,
ctree = if (exists("ctree")) c(ctree$overall, ctree$byClass) else NA,
rf = if (exists("RF")) c(RF$overall, RF$byClass) else NA,
AdaBag = if (exists("AdaBag")) c(AdaBag$overall, AdaBag$byClass) else NA,
treebag = if (exists("treebag")) c(treebag$overall, treebag$byClass) else NA,
bagFDA = if (exists("BagFDA")) c(BagFDA$overall, BagFDA$byClass) else NA,
gamboost = if (exists("gamboost")) c(gamboost$overall, gamboost$byClass) else NA,
bstSm = if (exists("bstSm")) c(bstSm$overall, bstSm$byClass) else NA,
bstTree = if (exists("bstTree")) c(bstTree$overall, bstTree$byClass) else NA,
gpls = if (exists("gpls")) c(gpls$overall, gpls$byClass) else NA,
pls = if (exists("pls")) c(pls$overall, pls$byClass) else NA,
spls = if (exists("spls")) c(spls$overall, spls$byClass) else NA
)
# Save Metrics-Performance Table
write.csv2(t(acc.df), paste0("../Results/provaAccuracyTable_",i,".csv"))
# # Build Selected genes list of list
# list_genes <- list(genes_svmRadial_SVMBased = genes_svmRadial_SVMBased[[1]],
#                    genes_svmPoly_SVMBased = genes_svmPoly_SVMBased[[1]],
#                    genes_svmLinear_SVMBased = genes_svmLinear_SVMBased[[1]],
#                    genes_voomDLDA_voomBased = genes_voomDLDA_voomBased[[1]],
#                    genes_voomDQDA_voomBased = genes_voomDQDA_voomBased[[1]],
#                    genes_voomNSC_voomBased = genes_voomNSC_voomBased[[1]],
#                    genes_PLDA_LDABased = genes_PLDA_LDABased[[1]],
#                    genes_PLDA2_LDABased = genes_PLDA2_LDABased[[1]],
#                    genes_sparseLDA_LDABased = genes_sparseLDA_LDABased[[1]],
#                    genes_rpart_treeBased = genes_rpart_treeBased[[1]],
#                    genes_cforest_treeBased = genes_cforest_treeBased[[1]],
#                    genes_ctree_treeBased = genes_ctree_treeBased[[1]],
#                    genes_rf_treeBased = genes_rf_treeBased[[1]],
#                    genes_AdaBag_baggedBased = genes_AdaBag_baggedBased[[1]],
#                    genes_treebag_baggedBased = genes_treebag_baggedBased[[1]],
#                    genes_gamboost_boostBased = genes_gamboost_boostBased[[1]],
#                    genes_bstSm_boostBased = genes_bstSm_boostBased[[1]],
#                    genes_bstTree_boostBased = genes_bstTree_boostBased[[1]],
#                    genes_gpls_plsBased = genes_gpls_plsBased[[1]],
#                    genes_pls_plsBased = genes_pls_plsBased[[1]],
#                    genes_spls_plsBased = genes_spls_plsBased[[1]])
# Build Selected genes list of list
list_genes <- list(
genes_svmRadial_SVMBased = if (exists("genes_svmRadial_SVMBased")) genes_svmRadial_SVMBased[[1]] else NA,
genes_svmPoly_SVMBased = if (exists("genes_svmPoly_SVMBased")) genes_svmPoly_SVMBased[[1]] else NA,
genes_svmLinear_SVMBased = if (exists("genes_svmLinear_SVMBased")) genes_svmLinear_SVMBased[[1]] else NA,
genes_voomDLDA_voomBased = if (exists("genes_voomDLDA_voomBased")) genes_voomDLDA_voomBased[[1]] else NA,
genes_voomDQDA_voomBased = if (exists("genes_voomDQDA_voomBased")) genes_voomDQDA_voomBased[[1]] else NA,
genes_voomNSC_voomBased = if (exists("genes_voomNSC_voomBased")) genes_voomNSC_voomBased[[1]] else NA,
genes_PLDA_LDABased = if (exists("genes_PLDA_LDABased")) genes_PLDA_LDABased[[1]] else NA,
genes_PLDA2_LDABased = if (exists("genes_PLDA2_LDABased")) genes_PLDA2_LDABased[[1]] else NA,
genes_sparseLDA_LDABased = if (exists("genes_sparseLDA_LDABased")) genes_sparseLDA_LDABased[[1]] else NA,
genes_rpart_treeBased = if (exists("genes_rpart_treeBased")) genes_rpart_treeBased[[1]] else NA,
genes_cforest_treeBased = if (exists("genes_cforest_treeBased")) genes_cforest_treeBased[[1]] else NA,
genes_ctree_treeBased = if (exists("genes_ctree_treeBased")) genes_ctree_treeBased[[1]] else NA,
genes_rf_treeBased = if (exists("genes_rf_treeBased")) genes_rf_treeBased[[1]] else NA,
genes_AdaBag_baggedBased = if (exists("genes_AdaBag_baggedBased")) genes_AdaBag_baggedBased[[1]] else NA,
genes_treebag_baggedBased = if (exists("genes_treebag_baggedBased")) genes_treebag_baggedBased[[1]] else NA,
genes_gamboost_boostBased = if (exists("genes_gamboost_boostBased")) genes_gamboost_boostBased[[1]] else NA,
genes_bstSm_boostBased = if (exists("genes_bstSm_boostBased")) genes_bstSm_boostBased[[1]] else NA,
genes_bstTree_boostBased = if (exists("genes_bstTree_boostBased")) genes_bstTree_boostBased[[1]] else NA,
genes_gpls_plsBased = if (exists("genes_gpls_plsBased")) genes_gpls_plsBased[[1]] else NA,
genes_pls_plsBased = if (exists("genes_pls_plsBased")) genes_pls_plsBased[[1]] else NA,
genes_spls_plsBased = if (exists("genes_spls_plsBased")) genes_spls_plsBased[[1]] else NA
)
# Save list of list of genes as RDS object
saveRDS(list_genes, paste0("../Results/provalist_genes_",i,".rds"))
return(list(acc.df, list_genes))
}
ensembleBP(methods = c("svmBased"))
a <- readRDS("../Results/provalist_genes_1.rds")
View(a)
b <- readRDS("../Results/provalist_genes_2.rds")
View(a)
View(b)
